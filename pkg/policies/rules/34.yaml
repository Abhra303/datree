id: 34,
name: 'Prevent EndpointSlice security vulnerability (CVE-2021-25737)'
uniqueName: 'ENDPOINTSLICE_CVE2021_25373_INCORRECT_ADDRESSES_VALUE'
enabledByDefault: false,
documentationUrl: 'https://hub.datree.io/-prevent-endpointslice-validation-from-enabling-host-network-hijack-cve-2021-25737'
messageOnFailue: Incorrect value for key `addresses` - IP address is within vulnerable ranges (127.0.0.0/8 and 169.254.0.0/16)
category: Security
schema:
  if:
    properties:
      kind:
        enum:
          - EndpointSlice
  then:
    properties:
      endpoints:
        type: array
        items:
          properties:
            addresses:
              type: array
              items:
                not:
                  oneOf:
                    - pattern: ^(169\.254\.)
                    - pattern: ^(127\.)
